# --- Core server runtime ---
# Node environment: development, test, or production
NODE_ENV=development
# Port for the NestJS backend (Vite proxy expects 8081)
PORT=8081
# Primary database connection (PostgreSQL URL)
DATABASE_URL=postgresql://squirrel:secret@localhost:5432/squirrel
# Redis connection used for rate limiting, queues, and WebSocket adapter
REDIS_URL=redis://localhost:6379
# Disable Redis/Bull in dev only (do not enable in prod)
REDIS_DISABLED=false

# --- Ownership / bootstrap admin ---
OWNER_EMAIL=founder@example.com
OWNER_PASSWORD=anesu0123@Q
# Allow bypassing auth in local dev only
AUTH_DEV_BYPASS=true

# --- Authentication and security ---
JWT_SECRET=replace-with-strong-secret
JWT_EXPIRES_IN=15m
REFRESH_EXPIRES_IN=7d
COOKIE_SECRET=replace-with-cookie-secret
# Optional CSRF override (defaults to JWT_SECRET)
CSRF_SECRET=
# 32-byte base64 key for encrypting secrets (generate with `openssl rand -base64 32`)
ENCRYPTION_KEY_BASE64=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=

# --- Network / CORS ---
# Comma-separated list of allowed origins. Include the web dev server to avoid CORS errors.
CORS_ORIGINS=http://localhost:5173
WS_REDIS_HOST=localhost
WS_REDIS_PORT=6379

# --- Feature flags ---
COLLAB_ENABLED=true
LIVE_LOGS_ENABLED=true
PAIR_DEBUG_ENABLED=true

# --- Rate limiting ---
RATE_LIMIT_WINDOW_SEC=60
RATE_LIMIT_MAX_REQUESTS=600

# --- Observability ---
OTEL_SERVICE_NAME=squirrel-backend
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_EXPORTER_OTLP_HEADERS=
OTEL_CONSOLE_EXPORTER_ENABLED=true
PROMETHEUS_ENABLED=true

# --- Billing / Paynow ---
PAYNOW_INTEGRATION_ID=paynow_test_id
PAYNOW_INTEGRATION_KEY=paynow_test_key
PAYNOW_RESULT_URL=http://localhost:5173/paynow/result
PAYNOW_RETURN_URL=http://localhost:5173/paynow/return
PAYNOW_PRO_MONTHLY_AMOUNT=29.99
PAYNOW_PRO_YEARLY_AMOUNT=299.99
BILLING_SUCCESS_URL=http://localhost:5173/billing/success
BILLING_CANCEL_URL=http://localhost:5173/billing/cancel
MARKETPLACE_SUCCESS_URL=http://localhost:5173/marketplace/success
MARKETPLACE_CANCEL_URL=http://localhost:5173/marketplace/cancel
BILLING_LEDGER_CURRENCY=usd
BILLING_SETTLEMENT_ENABLED=true
BILLING_SETTLEMENT_LOOKBACK_HOURS=24
BILLING_SETTLEMENT_MISMATCH_THRESHOLD=0.01
BILLING_SETTLEMENT_MAX_TRANSACTIONS=250
BILLING_SETTLEMENT_ALERT_WEBHOOK_URL=

# --- Sync (collaboration) ---
SYNC_VECTOR_CLOCK_TTL_SEC=3600
SYNC_VECTOR_DIVERGENCE_THRESHOLD=25
SYNC_PRESENCE_TTL_SEC=60

# --- Frontend defaults (read by Vite) ---
VITE_API_URL=http://localhost:8081
VITE_WS_URL=ws://localhost:5173
